{% extends "base.html" %}
{% block title %}–ì–∞—Ä–∞–∂ - {{ player.username }}{% endblock %}
{% block content %}
<div class="max-w-7xl mx-auto px-4 py-20">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <div class="text-center mb-20">
        <h1 class="hero-title mb-8">
            <i class="fas fa-warehouse"></i>
            –í–∞—à –ì–∞—Ä–∞–∂
        </h1>
        <div class="text-3xl font-bold flex items-center justify-center gap-4 flex-wrap">
            <span>–¢–∞–Ω–∫–æ–≤:</span>
            <span class="text-4xl text-emerald-400">{{ player_tanks|length }}</span>
            <span>–ö—É–ø–ª–µ–Ω–æ</span>
        </div>
    </div>

    {% if player_tanks %}
    <!-- –§–ò–õ–¨–¢–†–´ –ì–ê–†–ê–ñ–ê -->
    <div class="glass-panel p-8 mb-12">
        <h2 class="text-3xl font-bold mb-8 flex items-center gap-3">
            <i class="fas fa-filter"></i> –§–∏–ª—å—Ç—Ä—ã –≥–∞—Ä–∞–∂–∞
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <select id="garageNation" class="w-full bg-white/10 border border-white/20 rounded-2xl p-4 text-white text-lg backdrop-blur-sm">
                <option value="">üéØ –í—Å–µ –Ω–∞—Ü–∏–∏</option>
                <option value="ussr">üá∑üá∫ –°–°–°–†</option>
                <option value="germany">üá©üá™ –ì–µ—Ä–º–∞–Ω–∏—è</option>
            </select>
            <select id="garageTier" class="w-full bg-white/10 border border-white/20 rounded-2xl p-4 text-white text-lg backdrop-blur-sm">
                <option value="">üéØ –í—Å–µ —É—Ä–æ–≤–Ω–∏</option>
                {% for i in range(1, 11) %}
                <option value="{{ i }}">–£—Ä. {{ i }}</option>
                {% endfor %}
            </select>
            <button onclick="clearGarageFilters()" class="bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-500 text-white py-4 px-8 rounded-2xl font-bold text-lg">
                <i class="fas fa-times"></i> –û—á–∏—Å—Ç–∏—Ç—å
            </button>
        </div>
    </div>

    <!-- –¢–ê–ë–õ–ò–¶–ê –¢–ê–ù–ö–û–í -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 garage-grid" id="garageGrid">
        {% for tank_id in player_tanks %}
        {% set tank = tanks[tank_id] %}
        <div class="garage-tank-card group relative overflow-hidden h-full" 
             data-nation="{{ tank.nation }}" 
             data-tier="{{ tank.tier }}">
            
            <div class="glass-panel p-8 h-full flex flex-col justify-between transition-all duration-500 group-hover:scale-[1.02] relative z-10">
                <!-- –ü–†–ï–ú–ò–£–ú -->
                {% if tank.premium %}
                <div class="absolute top-4 right-4 bg-gradient-to-br from-yellow-400 to-orange-500 text-black text-xs font-bold px-3 py-1 rounded-full shadow-lg animate-pulse">
                    ‚≠ê –ü–†–ï–ú–ò–£–ú
                </div>
                {% endif %}

                <!-- –ù–ê–¶–ò–Ø + –£–†–û–í–ï–ù–¨ -->
                <div class="flex justify-between items-start mb-6">
                    <div class="text-3xl font-bold">
                        {% if tank.nation == 'ussr' %}üá∑üá∫{% elif tank.nation == 'germany' %}üá©üá™{% else %}üá∫üá≥{% endif %}
                    </div>
                    <div class="text-3xl font-black bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent">
                        –£—Ä. {{ tank.tier }}
                    </div>
                </div>

                <!-- –ù–ê–ó–í–ê–ù–ò–ï -->
                <h3 class="text-2xl font-black mb-6 text-center leading-tight flex-1">
                    {{ tank.name }}
                </h3>

                <!-- –°–¢–ê–¢–´ -->
                <div class="grid grid-cols-2 gap-4 mb-8">
                    <div class="p-4 bg-gradient-to-br from-red-500/20 to-red-600/20 rounded-2xl border border-red-400/30 text-center">
                        <div class="text-2xl font-bold text-red-400">{{ tank.hp }}</div>
                        <small class="text-red-300 uppercase tracking-wider">HP</small>
                    </div>
                    <div class="p-4 bg-gradient-to-br from-yellow-500/20 to-orange-600/20 rounded-2xl border border-yellow-400/30 text-center">
                        <div class="text-2xl font-bold text-yellow-400">{{ tank.damage }}</div>
                        <small class="text-yellow-300 uppercase tracking-wider">–£—Ä–æ–Ω</small>
                    </div>
                    <div class="p-4 bg-gradient-to-br from-blue-500/20 to-blue-600/20 rounded-2xl border border-blue-400/30 text-center">
                        <div class="text-2xl font-bold text-blue-400">{{ tank.pen }}</div>
                        <small class="text-blue-300 uppercase tracking-wider">–ü—Ä–æ–±–∏—Ç–∏–µ</small>
                    </div>
                    <div class="p-4 bg-gradient-to-br from-emerald-500/20 to-emerald-600/20 rounded-2xl border border-emerald-400/30 text-center">
                        <div class="text-2xl font-bold text-emerald-400">{{ tank.speed }}</div>
                        <small class="text-emerald-300 uppercase tracking-wider">–°–∫–æ—Ä–æ—Å—Ç—å</small>
                    </div>
                </div>

                <!-- –°–¢–ê–¢–£–° –ò –ö–ù–û–ü–ö–ò -->
                <div class="flex gap-3 pt-4 border-t border-white/10">
                    <div class="flex-1 text-center py-3 px-4 bg-gradient-to-r from-emerald-500/30 to-green-500/30 rounded-xl border border-emerald-400/50">
                        <div class="text-xl font-bold text-emerald-400">–ì–æ—Ç–æ–≤ –∫ –±–æ—é</div>
                        <div class="text-sm text-emerald-300">100% —ç–∫–∏–ø–∞–∂</div>
                    </div>
                    <a href="/battle?tank={{ tank_id }}" class="flex-1 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white py-3 px-4 rounded-xl font-bold text-lg shadow-xl hover:shadow-2xl hover:-translate-y-1 transition-all flex items-center justify-center gap-2">
                        <i class="fas fa-fire"></i>
                        –í –±–æ–π!
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    {% else %}
    <!-- –ü–£–°–¢–û–ô –ì–ê–†–ê–ñ -->
    <div class="text-center py-32">
        <div class="glass-panel max-w-2xl mx-auto p-20">
            <i class="fas fa-warehouse text-9xl text-gray-500 mb-8 opacity-50"></i>
            <h2 class="text-5xl font-black mb-6 text-gray-400">–ì–∞—Ä–∞–∂ –ø—É—Å—Ç</h2>
            <p class="text-xl text-gray-500 mb-12">–ö—É–ø–∏—Ç–µ –ø–µ—Ä–≤—ã–π —Ç–∞–Ω–∫ –≤ <a href="/shop" class="text-emerald-400 hover:text-emerald-300">–º–∞–≥–∞–∑–∏–Ω–µ</a>!</p>
            <a href="/shop" class="inline-flex items-center gap-4 bg-gradient-to-r from-emerald-600 to-green-600 text-white px-12 py-6 rounded-3xl font-bold text-2xl shadow-2xl hover:shadow-3xl hover:-translate-y-2 transition-all">
                <i class="fas fa-shopping-cart"></i>
                –ö—É–ø–∏—Ç—å —Ç–∞–Ω–∫
            </a>
        </div>
    </div>
    {% endif %}
</div>

<script>
function filterGarageTanks() {
    const nation = document.getElementById('garageNation').value;
    const tier = document.getElementById('garageTier').value;
    
    document.querySelectorAll('.garage-tank-card').forEach(card => {
        const show = (!nation || card.dataset.nation === nation) &&
                    (!tier || card.dataset.tier == tier);
        card.style.display = show ? 'block' : 'none';
    });
}

function clearGarageFilters() {
    document.getElementById('garageNation').value = '';
    document.getElementById('garageTier').value = '';
    filterGarageTanks();
}

document.addEventListener('DOMContentLoaded', () => {
    document.getElementById('garageNation').addEventListener('change', filterGarageTanks);
    document.getElementById('garageTier').addEventListener('change', filterGarageTanks);
    
    // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
    document.querySelectorAll('.garage-tank-card').forEach((card, index) => {
        setTimeout(() => card.style.opacity = '1', index * 100);
    });
});
</script>

<style>
.garage-tank-card {
    opacity: 0;
    transform: translateY(30px);
}
.group:hover .glass-panel {
    box-shadow: 0 35px 80px -20px rgba(59, 130, 246, 0.4);
}
@media (max-width: 768px) {
    .garage-grid { grid-template-columns: 1fr; }
}
</style>
{% endblock %}
